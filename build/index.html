<!DOCTYPE html>
<html ng-controller="Main" lang="en">
<head>
  <title ng-bind="pageTitle"></title>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">

  <!-- fileblock:css css -->
  <style>.ng-cloak,.x-ng-cloak,[data-ng-cloak],[ng-cloak],[ng\:cloak],[x-ng-cloak]{display:none!important}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:40px}body{padding-top:20px;padding-bottom:20px}.footer,.header,.marketing{padding-right:15px;padding-left:15px}.header{border-bottom:1px solid #e5e5e5}.header h3{padding-bottom:19px;margin-top:0;margin-bottom:0;line-height:40px}.footer{padding-top:19px;color:#777;border-top:1px solid #e5e5e5}@media (min-width:768px){.container{max-width:730px}}.container-narrow>hr{margin:30px 0}.jumbotron{text-align:center;border-bottom:1px solid #e5e5e5}.jumbotron .btn{padding:14px 24px;font-size:21px}.marketing{margin:40px 0}.marketing p+h4{margin-top:28px}@media screen and (min-width:768px){.footer,.header,.marketing{padding-right:0;padding-left:0}.header{margin-bottom:30px}.jumbotron{border-bottom:0}}</style>
  <!-- endfileblock -->
</head>

<body class="ng-cloak">

<div class="container">
  <div class="header">
    <ul class="nav nav-pills pull-right">
      <li ui-sref-active="active"><a ui-sref="homepage">Home</a></li>
      <li ui-sref-active="active"><a ui-sref="admin">Admin</a></li>
      <li ui-sref-active="active"><a ui-sref="login">Login</a></li>
    </ul>

    <h3 class="text-muted">Helium blog</h3>
  </div>

  <div class="progress" ng-if="globals.loading">
    <div class="progress-bar progress-bar-striped active" style="width: 100%">
      <span>Loading</span>
    </div>
  </div>

  <div class="row marketing">
    <ui-view></ui-view>
  </div>
</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.1/lodash.min.js"></script>
<script src="//sdk.amazonaws.com/js/aws-sdk-2.0.15.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.2.20/angular.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/angular-ui-router/0.2.10/angular-ui-router.min.js"></script>

<!-- fileblock:js js -->
<script>window.handleClientLoad=function(){angular.element(document).ready(function(){angular.bootstrap(document,["helium"])})};var Showdown={extensions:{}},forEach=Showdown.forEach=function(a,b){if("function"==typeof a.forEach)a.forEach(b);else{var c,d=a.length;for(c=0;c<d;c++)b(a[c],c,a)}},stdExtName=function(a){return a.replace(/[_-]||\s/g,"").toLowerCase()};Showdown.converter=function(a){var b,c,d,e=0,f=[],g=[];if("undefind"!=typeof module&&"undefined"!=typeof exports&&"undefind"!=typeof require){var h=require("fs");if(h){var i=h.readdirSync((__dirname||".")+"/extensions").filter(function(a){return~a.indexOf(".js")}).map(function(a){return a.replace(/\.js$/,"")});Showdown.forEach(i,function(a){var b=stdExtName(a);Showdown.extensions[b]=require("./extensions/"+a)})}}a&&a.extensions&&Showdown.forEach(a.extensions,function(a){"string"==typeof a&&(a=Showdown.extensions[stdExtName(a)]);if("function"!=typeof a)throw"Extension '"+a+"' could not be loaded.  It was either not found or is not a valid extension.";Showdown.forEach(a(this),function(a){a.type?"language"===a.type||"lang"===a.type?f.push(a):("output"===a.type||"html"===a.type)&&g.push(a):g.push(a)})}),this.makeHtml=function(a){return b={},c={},d=[],a=a.replace(/~/g,"~T"),a=a.replace(/\$/g,"~D"),a=a.replace(/\r\n/g,"\n"),a=a.replace(/\r/g,"\n"),a="\n\n"+a+"\n\n",a=L(a),a=a.replace(/^[ \t]+$/gm,""),Showdown.forEach(f,function(b){a=j(b,a)}),a=y(a),a=l(a),a=k(a),a=n(a),a=J(a),a=a.replace(/~D/g,"$$"),a=a.replace(/~T/g,"~"),Showdown.forEach(g,function(b){a=j(b,a)}),a};var j=function(a,b){if(a.regex){var c=new RegExp(a.regex,"g");return b.replace(c,a.replace)}if(a.filter)return a.filter(b)},k=function(a){return a+="~0",a=a.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|(?=~0))/gm,function(a,d,e,f,g){return d=d.toLowerCase(),b[d]=F(e),f?f+g:(g&&(c[d]=g.replace(/"/g,"&quot;")),"")}),a=a.replace(/~0/,""),a},l=function(a){a=a.replace(/\n/g,"\n\n");var b="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del|style|section|header|footer|nav|article|aside",c="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|style|section|header|footer|nav|article|aside";return a=a.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,m),a=a.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|style|section|header|footer|nav|article|aside)\b[^\r]*?<\/\2>[ \t]*(?=\n+)\n)/gm,m),a=a.replace(/(\n[ ]{0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,m),a=a.replace(/(\n\n[ ]{0,3}<!(--[^\r]*?--\s*)+>[ \t]*(?=\n{2,}))/g,m),a=a.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,m),a=a.replace(/\n\n/g,"\n"),a},m=function(a,b){var c=b;return c=c.replace(/\n\n/g,"\n"),c=c.replace(/^\n/,""),c=c.replace(/\n+$/g,""),c="\n\n~K"+(d.push(c)-1)+"K\n\n",c},n=function(a){a=u(a);var b=z("<hr />");return a=a.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,b),a=a.replace(/^[ ]{0,2}([ ]?\-[ ]?){3,}[ \t]*$/gm,b),a=a.replace(/^[ ]{0,2}([ ]?\_[ ]?){3,}[ \t]*$/gm,b),a=w(a),a=x(a),a=D(a),a=l(a),a=E(a),a},o=function(a){return a=A(a),a=p(a),a=G(a),a=s(a),a=q(a),a=H(a),a=F(a),a=C(a),a=a.replace(/  +\n/g," <br />\n"),a},p=function(a){var b=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--.*?--\s*)+>)/gi;return a=a.replace(b,function(a){var b=a.replace(/(.)<\/?code>(?=.)/g,"$1`");return b=M(b,"\\`*_"),b}),a},q=function(a){return a=a.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,r),a=a.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?(.*?(?:\(.*?\).*?)?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,r),a=a.replace(/(\[([^\[\]]+)\])()()()()()/g,r),a},r=function(a,d,e,f,g,h,i,j){void 0==j&&(j="");var k=d,l=e,m=f.toLowerCase(),n=g,o=j;if(""==n){""==m&&(m=l.toLowerCase().replace(/ ?\n/g," ")),n="#"+m;if(void 0!=b[m])n=b[m],void 0!=c[m]&&(o=c[m]);else{if(!(k.search(/\(\s*\)$/m)>-1))return k;n=""}}n=M(n,"*_");var p='<a href="'+n+'"';return""!=o&&(o=o.replace(/"/g,"&quot;"),o=M(o,"*_"),p+=' title="'+o+'"'),p+=">"+l+"</a>",p},s=function(a){return a=a.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,t),a=a.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,t),a},t=function(a,d,e,f,g,h,i,j){var k=d,l=e,m=f.toLowerCase(),n=g,o=j;o||(o="");if(""==n){""==m&&(m=l.toLowerCase().replace(/ ?\n/g," ")),n="#"+m;if(void 0==b[m])return k;n=b[m],void 0!=c[m]&&(o=c[m])}l=l.replace(/"/g,"&quot;"),n=M(n,"*_");var p='<img src="'+n+'" alt="'+l+'"';return o=o.replace(/"/g,"&quot;"),o=M(o,"*_"),p+=' title="'+o+'"',p+=" />",p},u=function(a){function b(a){return a.replace(/[^\w]/g,"").toLowerCase()}return a=a.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(a,c){return z('<h1 id="'+b(c)+'">'+o(c)+"</h1>")}),a=a.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(a,c){return z('<h2 id="'+b(c)+'">'+o(c)+"</h2>")}),a=a.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(a,c,d){var e=c.length;return z("<h"+e+' id="'+b(d)+'">'+o(d)+"</h"+e+">")}),a},v,w=function(a){a+="~0";var b=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;return e?a=a.replace(b,function(a,b,c){var d=b,e=c.search(/[*+-]/g)>-1?"ul":"ol";d=d.replace(/\n{2,}/g,"\n\n\n");var f=v(d);return f=f.replace(/\s+$/,""),f="<"+e+">"+f+"</"+e+">\n",f}):(b=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g,a=a.replace(b,function(a,b,c,d){var e=b,f=c,g=d.search(/[*+-]/g)>-1?"ul":"ol",f=f.replace(/\n{2,}/g,"\n\n\n"),h=v(f);return h=e+"<"+g+">\n"+h+"</"+g+">\n",h})),a=a.replace(/~0/,""),a};v=function(a){return e++,a=a.replace(/\n{2,}$/,"\n"),a+="~0",a=a.replace(/(\n)?(^[ \t]*)([*+-]|\d+[.])[ \t]+([^\r]+?(\n{1,2}))(?=\n*(~0|\2([*+-]|\d+[.])[ \t]+))/gm,function(a,b,c,d,e){var f=e,g=b,h=c;return g||f.search(/\n{2,}/)>-1?f=n(K(f)):(f=w(K(f)),f=f.replace(/\n$/,""),f=o(f)),"<li>"+f+"</li>\n"}),a=a.replace(/~0/g,""),e--,a};var x=function(a){return a+="~0",a=a.replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(a,b,c){var d=b,e=c;return d=B(K(d)),d=L(d),d=d.replace(/^\n+/g,""),d=d.replace(/\n+$/g,""),d="<pre><code>"+d+"\n</code></pre>",z(d)+e}),a=a.replace(/~0/,""),a},y=function(a){return a+="~0",a=a.replace(/(?:^|\n)```(.*)\n([\s\S]*?)\n```/g,function(a,b,c){var d=b,e=c;return e=B(e),e=L(e),e=e.replace(/^\n+/g,""),e=e.replace(/\n+$/g,""),e="<pre><code"+(d?' class="'+d+'"':"")+">"+e+"\n</code></pre>",z(e)}),a=a.replace(/~0/,""),a},z=function(a){return a=a.replace(/(^\n+|\n+$)/g,""),"\n\n~K"+(d.push(a)-1)+"K\n\n"},A=function(a){return a=a.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(a,b,c,d,e){var f=d;return f=f.replace(/^([ \t]*)/g,""),f=f.replace(/[ \t]*$/g,""),f=B(f),b+"<code>"+f+"</code>"}),a},B=function(a){return a=a.replace(/&/g,"&amp;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a=M(a,"*_{}[]\\",!1),a},C=function(a){return a=a.replace(/(\*\*|__)(?=\S)([^\r]*?\S[*_]*)\1/g,"<strong>$2</strong>"),a=a.replace(/(\*|_)(?=\S)([^\r]*?\S)\1/g,"<em>$2</em>"),a},D=function(a){return a=a.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(a,b){var c=b;return c=c.replace(/^[ \t]*>[ \t]?/gm,"~0"),c=c.replace(/~0/g,""),c=c.replace(/^[ \t]+$/gm,""),c=n(c),c=c.replace(/(^|\n)/g,"$1  "),c=c.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(a,b){var c=b;return c=c.replace(/^  /gm,"~0"),c=c.replace(/~0/g,""),c}),z("<blockquote>\n"+c+"\n</blockquote>")}),a},E=function(a){a=a.replace(/^\n+/g,""),a=a.replace(/\n+$/g,"");var b=a.split(/\n{2,}/g),c=[],e=b.length;for(var f=0;f<e;f++){var g=b[f];g.search(/~K(\d+)K/g)>=0?c.push(g):g.search(/\S/)>=0&&(g=o(g),g=g.replace(/^([ \t]*)/g,"<p>"),g+="</p>",c.push(g))}e=c.length;for(var f=0;f<e;f++)while(c[f].search(/~K(\d+)K/)>=0){var h=d[RegExp.$1];h=h.replace(/\$/g,"$$$$"),c[f]=c[f].replace(/~K\d+K/,h)}return c.join("\n\n")},F=function(a){return a=a.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;"),a=a.replace(/<(?![a-z\/?\$!])/gi,"&lt;"),a},G=function(a){return a=a.replace(/\\(\\)/g,N),a=a.replace(/\\([`*_{}\[\]()>#+-.!])/g,N),a},H=function(a){return a=a.replace(/<((https?|ftp|dict):[^'">\s]+)>/gi,'<a href="$1">$1</a>'),a=a.replace(/<(?:mailto:)?([-.\w]+\@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,function(a,b){return I(J(b))}),a},I=function(a){var b=[function(a){return"&#"+a.charCodeAt(0)+";"},function(a){return"&#x"+a.charCodeAt(0).toString(16)+";"},function(a){return a}];return a="mailto:"+a,a=a.replace(/./g,function(a){if("@"==a)a=b[Math.floor(2*Math.random())](a);else if(":"!=a){var c=Math.random();a=c>.9?b[2](a):c>.45?b[1](a):b[0](a)}return a}),a='<a href="'+a+'">'+a+"</a>",a=a.replace(/">.+:/g,'">'),a},J=function(a){return a=a.replace(/~E(\d+)E/g,function(a,b){var c=parseInt(b);return String.fromCharCode(c)}),a},K=function(a){return a=a.replace(/^(\t|[ ]{1,4})/gm,"~0"),a=a.replace(/~0/g,""),a},L=function(a){return a=a.replace(/\t(?=\t)/g,"    "),a=a.replace(/\t/g,"~A~B"),a=a.replace(/~B(.+?)~A/g,function(a,b,c){var d=b,e=4-d.length%4;for(var f=0;f<e;f++)d+=" ";return d}),a=a.replace(/~A/g,"    "),a=a.replace(/~B/g,""),a},M=function(a,b,c){var d="(["+b.replace(/([\[\]\\])/g,"\\$1")+"])";c&&(d="\\\\"+d);var e=new RegExp(d,"g");return a=a.replace(e,N),a},N=function(a,b){var c=b.charCodeAt(0);return"~E"+c+"E"}},"undefined"!=typeof module&&(module.exports=Showdown),"function"==typeof define&&define.amd&&define("showdown",function(){return Showdown});!function(q,g,r){function F(a){var d=[];t(d,g.noop).chars(a);return d.join("")}function m(a){var d={};a=a.split(",");var c;for(c=0;c<a.length;c++)d[a[c]]=!0;return d}function G(a,d){function c(a,b,c,h){b=g.lowercase(b);if(u[b])for(;f.last()&&v[f.last()];)e("",f.last());w[b]&&f.last()==b&&e("",b);(h=x[b]||!!h)||f.push(b);var n={};c.replace(H,function(a,b,d,c,e){n[b]=s(d||c||e||"")});d.start&&d.start(b,n,h)}function e(a,b){var c=0,e;if(b=g.lowercase(b))for(c=f.length-1;0<=c&&f[c]!=b;c--);if(0<=c){for(e=f.length-1;e>=c;e--)d.end&&d.end(f[e]);f.length=c}}"string"!==typeof a&&(a=null===a||"undefined"===typeof a?"":""+a);var b,l,f=[],n=a,h;for(f.last=function(){return f[f.length-1]};a;){h="";l=!0;if(f.last()&&y[f.last()])a=a.replace(RegExp("(.*)<\\s*\\/\\s*"+f.last()+"[^>]*>","i"),function(a,b){b=b.replace(I,"$1").replace(J,"$1");d.chars&&d.chars(s(b));return""}),e("",f.last());else{if(0===a.indexOf("<!--"))b=a.indexOf("--",4),0<=b&&a.lastIndexOf("-->",b)===b&&(d.comment&&d.comment(a.substring(4,b)),a=a.substring(b+3),l=!1);else if(z.test(a)){if(b=a.match(z))a=a.replace(b[0],""),l=!1}else if(K.test(a)){if(b=a.match(A))a=a.substring(b[0].length),b[0].replace(A,e),l=!1}else L.test(a)&&((b=a.match(B))?(b[4]&&(a=a.substring(b[0].length),b[0].replace(B,c)),l=!1):(h+="<",a=a.substring(1)));l&&(b=a.indexOf("<"),h+=0>b?a:a.substring(0,b),a=0>b?"":a.substring(b),d.chars&&d.chars(s(h)))}if(a==n)throw M("badparse",a);n=a}e()}function s(a){if(!a)return"";var d=N.exec(a);a=d[1];var c=d[3];if(d=d[2])p.innerHTML=d.replace(/</g,"&lt;"),d="textContent"in p?p.textContent:p.innerText;return a+d+c}function C(a){return a.replace(/&/g,"&amp;").replace(O,function(a){var c=a.charCodeAt(0);a=a.charCodeAt(1);return"&#"+(1024*(c-55296)+(a-56320)+65536)+";"}).replace(P,function(a){return"&#"+a.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function t(a,d){var c=!1,e=g.bind(a,a.push);return{start:function(a,l,f){a=g.lowercase(a);!c&&y[a]&&(c=a);c||!0!==D[a]||(e("<"),e(a),g.forEach(l,function(c,f){var k=g.lowercase(f),l="img"===a&&"src"===k||"background"===k;!0!==Q[k]||!0===E[k]&&!d(c,l)||(e(" "),e(f),e('="'),e(C(c)),e('"'))}),e(f?"/>":">"))},end:function(a){a=g.lowercase(a);c||!0!==D[a]||(e("</"),e(a),e(">"));a==c&&(c=!1)},chars:function(a){c||e(C(a))}}}var M=g.$$minErr("$sanitize"),B=/^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/,A=/^<\/\s*([\w:-]+)[^>]*>/,H=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,L=/^</,K=/^<\//,I=/\x3c!--(.*?)--\x3e/g,z=/<!DOCTYPE([^>]*?)>/i,J=/<!\[CDATA\[(.*?)]]\x3e/g,O=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,P=/([^\#-~| |!])/g,x=m("area,br,col,hr,img,wbr");q=m("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr");r=m("rp,rt");var w=g.extend({},r,q),u=g.extend({},q,m("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),v=g.extend({},r,m("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),y=m("script,style"),D=g.extend({},x,u,v,w),E=m("background,cite,href,longdesc,src,usemap"),Q=g.extend({},E,m("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),p=document.createElement("pre"),N=/^(\s*)([\s\S]*?)(\s*)$/;g.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(a){return function(d){var c=[];G(d,t(c,function(c,b){return!/^unsafe/.test(a(c,b))}));return c.join("")}}]});g.module("ngSanitize").filter("linky",["$sanitize",function(a){var d=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"]/,c=/^mailto:/;return function(e,b){function l(a){a&&k.push(F(a))}function f(a,c){k.push("<a ");g.isDefined(b)&&(k.push('target="'),k.push(b),k.push('" '));k.push('href="');k.push(a);k.push('">');l(c);k.push("</a>")}if(!e)return e;for(var n,h=e,k=[],m,p;n=h.match(d);)m=n[0],n[2]==n[3]&&(m="mailto:"+m),p=n.index,l(h.substr(0,p)),f(m,n[0].replace(c,"")),h=h.substring(p+n[0].length);l(h);return a(k.join(""))}}])}(window,window.angular);"use strict";angular.module("btford.markdown",["ngSanitize"]).provider("markdownConverter",function(){var opts={};return{config:function(newOpts){opts=newOpts},$get:function(){return new Showdown.converter(opts)}}}).directive("btfMarkdown",function($sanitize,markdownConverter){return{restrict:"AE",link:function(scope,element,attrs){if(attrs.btfMarkdown)scope.$watch(attrs.btfMarkdown,function(newVal){var html=newVal?$sanitize(markdownConverter.makeHtml(newVal)):"";element.html(html)});else{var html=$sanitize(markdownConverter.makeHtml(element.text()));element.html(html)}}}});</script>
<script>angular.module("helium.templates",["html/admin.html","html/admin.manage-posts.html","html/admin.post.html","html/authenticate.html","html/helium-loading.html","html/homepage.html","html/login.html","html/post.html"]),angular.module("html/admin.html",[]).run(["$templateCache",function(a){a.put("html/admin.html",'<div ng-if="verificationResults === true"><h3>Do things <small>{{action}}</small></h3><div ui-view><button type="button" class="btn btn-primary btn-lg btn-block" ng-click="newPost()">Make a new post</button><hr><button type="button" class="btn btn-primary btn-lg btn-block" ng-click="managePosts()">Manage existing posts</button></div></div>')}]),angular.module("html/admin.manage-posts.html",[]).run(["$templateCache",function(a){a.put("html/admin.manage-posts.html",'<div><ul class="list-group"><li class="list-group-item" ng-repeat="post in posts">{{post.title}} <button type="button" class="btn btn-danger btn-xs badge" ng-click="deletePost(post)">Delete</button></li><li class="list-group-item" ng-if="posts.length === 0">You don\'t have any posts to manage.</li></ul></div>')}]),angular.module("html/admin.post.html",[]).run(["$templateCache",function(a){a.put("html/admin.post.html",'<div><form class="form-horizontal" role="form" name="newPostForm"><div class="form-group"><textarea class="form-control" rows="20" ng-model="postBody" placeholder="Post body. Use Markdown." id="postBody" ng-disabled="globals.loading === true" required></textarea></div><div class="form-group"><input type="text" id="postTitle" ng-model="postTitle" class="form-control" placeholder="Post title" ng-disabled="globals.loading === true" required></div><div class="alert alert-danger" role="alert" ng-if="errorMessage !== undefined">{{errorMessage}}</div><div class="form-group"><button type="button" class="btn btn-primary btn-lg btn-block" ng-click="submitPost()" ng-disabled="globals.loading === true">Submit</button></div></form></div>')}]),angular.module("html/authenticate.html",[]).run(["$templateCache",function(a){a.put("html/authenticate.html","<pre>{{error | json}}</pre>")}]),angular.module("html/helium-loading.html",[]).run(["$templateCache",function(a){a.put("html/helium-loading.html",'<div ng-if="loading === true"><h2>Loading...</h2><div class="progress"><div class="progress-bar progress-bar-striped active" role="progressbar" style="width: 100%"></div></div></div>')}]),angular.module("html/homepage.html",[]).run(["$templateCache",function(a){a.put("html/homepage.html",'<div><h2 ng-repeat="post in posts"><a ui-sref="post({ postId: post.id })">{{post.title}}</a> <small>{{post.id | date: \'fullDate\'}}</small></h2><h2 ng-if="posts.length === 0">You don\'t have any posts, yet.</h2></div>')}]),angular.module("html/login.html",[]).run(["$templateCache",function(a){a.put("html/login.html",'<div><div class="alert alert-warning" role="alert" ng-if="initializing">{{initializingMessage}}</div><div class="alert alert-danger" role="alert" ng-if="message && initializing !== true">{{message}}</div><button type="button" class="btn btn-primary btn-lg btn-block" ng-click="authenticateWithGoogle()" ng-disabled="initializing === true">Login</button></div>')}]),angular.module("html/post.html",[]).run(["$templateCache",function(a){a.put("html/post.html","<article><h1>{{post.title}} <small>{{post.id | date:'fullDate'}}</small></h1><div btf-markdown=\"post.body\"></div></article>")}]),angular.module("helium",["helium.templates","ui.router","btford.markdown"]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(a,b,c){a.state("homepage",{url:"/",templateUrl:"html/homepage.html",controller:"Homepage"}).state("login",{url:"/login?state&authError",templateUrl:"html/login.html",controller:"Login"}).state("admin",{url:"/admin",templateUrl:"html/admin.html",controller:"Admin",resolve:{verificationResults:["user",function(a){return a.verify().then(function(){return!0},function(){return!1})}]}}).state("admin.post",{url:"/post",templateUrl:"html/admin.post.html",controller:"AdminPost"}).state("admin.managePosts",{url:"/manage-posts",templateUrl:"html/admin.manage-posts.html",controller:"AdminManagePosts"}).state("post",{url:"/{postId:[0-9]{13,}}",templateUrl:"html/post.html",controller:"Post"}),b.otherwise("/"),c.html5Mode(!1).hashPrefix("!"),String.prototype.format||(String.prototype.format=function(){var a=arguments;return this.replace(/\{(\d+)\}/g,function(b,c){return c in a?a[c]:b})})}]),angular.module("helium").service("amazonApi",["$q","config","user","localStorage","$http",function(a,b,c,d,e){var f={},g=b.amazonRoleArn,h=b.amazonS3BucketName,i="https://s3.amazonaws.com/"+h,j={params:{Bucket:h}};return angular.extend(f,{authenticate:function(){return c.verify().then(function(){return(null===AWS.config.credentials||AWS.config.credentials.params.RoleArn!==g)&&(AWS.config.credentials=new AWS.WebIdentityCredentials({RoleArn:g,WebIdentityToken:d.getVal("idToken")})),!0})},uploadJson:function(a){return a.body=angular.toJson(a.body),a.type="application/json",f.uploadFile(a)},uploadFile:function(b){return f.authenticate().then(function(){var c=a.defer();return new AWS.S3(j).putObject({Bucket:h,Key:b.key,Body:b.body||b,ContentType:b.type,ACL:b.acl}).on("httpUploadProgress",function(a){c.notify({loaded:a.loaded,total:a.total})}).on("complete",function(a){c.resolve(a)}).on("error",function(a){console.log(a),c.resolve(a)}).send(),c.promise})},getObject:function(b){return f.authenticate().then(function(){var c=a.defer();return new AWS.S3(j).getObject({Bucket:h,Key:b}).on("complete",function(a){c.resolve(a)}).on("error",function(a){console.log(a),c.resolve({error:a})}).send(),c.promise})},getFile:function(b){var d={method:"GET",url:i+"/"+b};return c.hasValidCredentials()&&(d.headers={"cache-control":"no-cache"}),e(d).then(function(a){return a.data},function(b){return a.reject({error:b.statusText})})},deleteObject:function(b){return f.authenticate().then(function(){var c=a.defer();return new AWS.S3(j).deleteObject({Bucket:h,Key:b}).on("complete",function(a){c.resolve(a)}).on("error",function(a){c.resolve({error:a})}).send(),c.promise})}})}]),angular.module("helium").service("blogManager",["amazonApi","systemConfig","$q","utils","$state",function(a,b,c,d,e){var f={},g=b.general.fileNames.state,h=b.general.filePaths.state+g;return angular.extend(f,{updateState:function(b,d){c.all().then(function(){return d!==!0?f.getState():b}).then(function(c){return a.uploadJson({key:h,body:angular.extend(c,b),acl:"public-read"})})},initialize:function(){var b={key:h,body:{latestPostMapNumber:1,tags:[]},acl:"public-read"},e={key:d.getPostMapKey(1),body:{posts:[]},acl:"public-read"};return c.all({state:a.uploadJson(angular.copy(b)).then(function(){return b.body}),postMap:a.uploadJson(angular.copy(e)).then(function(){return e.body})}).then(function(a){return a},function(a){return c.reject(a)})},getState:function(){return a.getFile(h).then(function(a){return{state:a}},function(a){return"Forbidden"===a.error?f.initialize():c.reject(a)}).then(function(a){return a.state},function(a){return a.error===b.messages.googleAuthenticationError&&e.go("login",{authError:b.messages.blogNotInitialized}),c.reject(a)})}})}]),angular.module("helium").service("localStorage",function(){return{setVal:function(a,b){localStorage[a]=angular.toJson({value:b})},getVal:function(a){return void 0!==localStorage[a]?angular.fromJson(localStorage[a]).value:null}}}),angular.module("helium").service("postManager",["$q","utils","amazonApi","blogManager","systemConfig","postMapManager",function(a,b,c,d,e,f){function g(a){return e.general.filePaths.posts+a+".json"}var h={};return angular.extend(h,{savePost:function(b){var d={};return d.key=g(b.id),d.body=b,d.acl="public-read",a.all({uploadPost:c.uploadJson(d),updatePostMaps:f.update(b)})},getPosts:function(){return d.getState().then(function(a){return b.getPostMapKey(a.latestPostMapNumber)}).then(function(a){return c.getFile(a)}).then(function(a){return a.posts})},getPost:function(a){return c.getFile(g(a)).then(function(a){return a})},generateId:function(){return b.currentTime()},deletePost:function(b){return a.all({deletePostFile:c.deleteObject(g(b.id)),updatePostMaps:f.update(b,!0)})}})}]),angular.module("helium").service("postMapManager",["blogManager","amazonApi","systemConfig","$q","utils",function(a,b,c,d,e){var f={},g=c.general.postMapLimit,h="",i={};return angular.extend(f,{update:function(c,f){return a.getState().then(function(a){return a}).then(function(a){return i=a,h=e.getPostMapKey(i.latestPostMapNumber),b.getFile(h)}).then(function(j){var k={title:c.title,tags:c.tags,id:c.id},l={},m={};return f!==!0?(j.posts.length>=g?(m.updateState=a.updateState(++i.latestPostMapNumber,!0),h=e.getPostMapKey(i.latestPostMapNumber),l.body={posts:[k]}):(j.posts.unshift(k),l.body=j),l.key=h,l.acl="public-read",m.uploadPostMapFile=b.uploadJson(l)):j.posts.length<=1?1!==i.latestPostMapNumber?(m.deletePostMap=b.deleteObject(e.getPostMapKey(i.latestPostMapNumber)),m.updateState=a.updateState(--i.latestPostMapNumber,!0)):(j.posts=[],l.body=j,l.key=e.getPostMapKey(i.latestPostMapNumber),l.acl="public-read",m.uploadPostMapFile=b.uploadJson(l)):(_.remove(j.posts,{id:c.id}),l.body=j,l.key=e.getPostMapKey(i.latestPostMapNumber),l.acl="public-read",m.uploadPostMapFile=b.uploadJson(l)),d.all(m)})}})}]),angular.module("helium").constant("systemConfig",{general:{postMapLimit:10,filePaths:{posts:"content/posts/",postMaps:"content/post-maps/",state:"content/"},fileNames:{state:"state.json"}},messages:{adminAuthError:"Restricted area. You need to log-in.",invalidForm:"You need to fill things out.",googleAuthenticationError:"User could not be authenticated with Google.",blogNotInitialized:"This blog has not been initialized yet. If you are the admin, log-in to kick off automatic initialization.",initializing:"Please wait while your blog is being initialized for first time use."}}),angular.module("helium").service("user",["config","systemConfig","$location","localStorage","utils","$q",function(a,b,c,d,e,f){var g={},h=a.googleClientId;return angular.extend(g,{authenticateWithGoogle:function(a){var b=f.defer();return a=a||{},a.immediate=void 0===a.immediate,gapi.auth.authorize({client_id:h,response_type:"token id_token",immediate:a.immediate,scope:"email"},function(a){void 0!==a.error?b.reject(a):(d.setVal("credentialsExpirationTime",e.currentTime()+36e5),d.setVal("idToken",a.id_token),b.resolve(a))}),b.promise},hasValidCredentials:function(){var a=e.currentTime(),b=d.getVal("credentialsExpirationTime");return void 0!==b&&b>a},verify:function(){var a=f.defer();return this.hasValidCredentials()?a.resolve(!0):g.authenticateWithGoogle().then(function(){a.resolve(!0)},function(){a.reject({error:b.messages.googleAuthenticationError})}),a.promise}})}]),angular.module("helium").service("utils",["systemConfig",function(a){return{currentTime:function(){return(new Date).getTime()},parseHashQs:function(){for(var a,b={},c=location.hash.substring(1),d=/([^&=]+)=([^&]*)/g;a=d.exec(c);)b[decodeURIComponent(a[1])]=decodeURIComponent(a[2]);return b},getPostMapKey:function(b){return"{0}post-map-{1}.json".format(a.general.filePaths.postMaps,b)}}}]),angular.module("helium").controller("Admin",["$scope","verificationResults","$state","$rootScope","systemConfig",function(a,b,c,d,e){function f(b){switch(b){case"admin.post":a.action="Make a new post";break;case"admin.managePosts":a.action="Manage posts";break;default:a.action=""}}return b!==!0?(c.go("login",{authError:e.messages.adminAuthError}),!1):(angular.extend(a,{verificationResults:b,newPost:function(){c.go("admin.post")},managePosts:function(){c.go("admin.managePosts")}}),f(c.current.name),void d.$on("$stateChangeSuccess",function(a,b){f(b.name)}))}]),angular.module("helium").controller("AdminManagePosts",["$scope","postManager",function(a,b){angular.extend(a,{deletePost:function(c){a.globals.loading=!0,b.deletePost(c).then(function(){return b.getPosts()}).then(function(b){a.posts=b}).finally(function(){a.globals.loading=!1})}}),a.globals.loading=!0,b.getPosts().then(function(b){a.posts=b}).finally(function(){a.globals.loading=!1})}]),angular.module("helium").controller("AdminPost",["$scope","postManager","systemConfig","$state",function(a,b,c,d){var e=b.generateId();angular.extend(a,{submitPost:function(){a.newPostForm.$valid===!0?(a.globals.loading=!0,b.savePost({title:a.postTitle,body:a.postBody,id:e}).then(function(){d.go("post",{postId:e})}).finally(function(){a.globals.loading=!1})):a.errorMessage=c.messages.invalidForm}})}]),angular.module("helium").controller("Homepage",["$scope","postManager",function(a,b){a.globals.loading=!0,b.getPosts().then(function(b){a.posts=b}).finally(function(){a.globals.loading=!1})}]),angular.module("helium").controller("Login",["$scope","user","$state","$stateParams","systemConfig","blogManager",function(a,b,c,d,e,f){angular.extend(a,{message:d.authError,authenticateWithGoogle:function(){return b.authenticateWithGoogle({immediate:!1}).then(function(){return d.authError===e.messages.blogNotInitialized?(a.initializingMessage=e.messages.initializing,a.initializing=!0,f.initialize()):!0},function(b){a.message=b.error}).then(function(){a.initializing=!1,c.go("admin")})}})}]),angular.module("helium").controller("Main",["$scope","config",function(a,b){a.globals={loading:!1},a.pageTitle=b.blogTitle}]),angular.module("helium").controller("Post",["$scope","$stateParams","postManager",function(a,b,c){var d=b.postId;a.globals.loading=!0,c.getPost(d).then(function(b){a.post=b}).finally(function(){a.globals.loading=!1})}]),angular.module("helium").directive("heliumLoading",function(){return{restrict:"E",templateUrl:"html/helium-loading.html"}});</script>
<script>angular.module('helium')

.constant('config',
  {
    blogTitle: 'Helium blog',

    googleClientId: '712050489687-62tf7qp59i5932la9jsmkvllbo2qr25g.apps.googleusercontent.com',

    amazonS3BucketName: 'mk-helium-blog',

    amazonRoleArn: 'arn:aws:iam::901881000271:role/helium-blogger'
  }
)</script>
<!-- endfileblock -->

<script src="//apis.google.com/js/client.js?onload=handleClientLoad"></script>

</body>
</html>