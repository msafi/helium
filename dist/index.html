<!DOCTYPE html><html ng-controller="Main" lang="en"><head>

<!-- fileblock:js config -->
<script>var heliumConfigurations = {
  "name": "Helium Development",
  "siteUrl": "http://helium-dev.s3-website-us-east-1.amazonaws.com/",
  "googleClientId": "712050489687-62tf7qp59i5932la9jsmkvllbo2qr25g.apps.googleusercontent.com",
  "amazonS3BucketName": "helium-dev",
  "amazonRoleArn": "arn:aws:iam::901881000271:role/helium-dev",
  "amazonAccountId": "901881000271",
  "amazonCognitoIdentityPoolId": "us-east-1:3b9d95f2-3f63-4d7d-9fd8-75d1462e96db",
  "amazonCognitoRoleArn": "arn:aws:iam::901881000271:role/Cognito_heliumUnauth_DefaultRole",
  "picture": "http://helium-dev.s3-website-us-east-1.amazonaws.com/content/media/unnamed.jpg"
};;;</script>
<!-- endfileblock -->

<title ng-bind="pageTitle.value"></title>

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">

<!-- fileblock:css css -->
<style>.away{margin-left:99999px}[ng-click]{cursor:pointer}.admin-dropdown{margin-top:7px}.ng-cloak,.x-ng-cloak,[data-ng-cloak],[ng-cloak],[ng\:cloak],[x-ng-cloak]{display:none!important}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:40px}body{padding-top:20px;padding-bottom:20px}.footer,.header,.marketing{padding-right:15px;padding-left:15px}.header{border-bottom:1px solid #e5e5e5}.header h3{padding-bottom:19px;margin-top:0;margin-bottom:0;line-height:40px}.footer{padding-top:19px;color:#777;border-top:1px solid #e5e5e5}@media (min-width:768px){.container{max-width:730px}}.container-narrow>hr{margin:30px 0}.jumbotron{text-align:center;border-bottom:1px solid #e5e5e5}.jumbotron .btn{padding:14px 24px;font-size:21px}.marketing{margin:40px 0}.marketing p+h4{margin-top:28px}@media screen and (min-width:768px){.footer,.header,.marketing{padding-right:0;padding-left:0}.header{margin-bottom:30px}.jumbotron{border-bottom:0}}</style>
<!-- endfileblock -->
</head>

<body class="ng-cloak">

<div class="container">
  <div class="header">
    <ng-include ng-if="isAdmin() === true" src="'html/admin-menu.html'"></ng-include>

    <a ui-sref="homepage"><h3 class="text-muted" ng-bind="name"></h3></a>
  </div>

  <div class="progress" ng-if="globals.loading">
    <div class="progress-bar progress-bar-striped active" style="width: 100%">
      <span>Loading</span>
    </div>
  </div>

  <div class="row marketing">
    <ui-view></ui-view>
  </div>
</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.1/lodash.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script src="//sdk.amazonaws.com/js/aws-sdk-2.0.15.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.2.20/angular.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/angular-ui-router/0.2.10/angular-ui-router.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/showdown/0.3.1/showdown.min.js"></script>

<!-- fileblock:js js -->
<script>window.handleClientLoad=function(){angular.element(document).ready(function(){angular.bootstrap(document,["helium"])})};!function(q,g,r){function F(a){var d=[];t(d,g.noop).chars(a);return d.join("")}function m(a){var d={};a=a.split(",");var c;for(c=0;c<a.length;c++)d[a[c]]=!0;return d}function G(a,d){function c(a,b,c,h){b=g.lowercase(b);if(u[b])for(;f.last()&&v[f.last()];)e("",f.last());w[b]&&f.last()==b&&e("",b);(h=x[b]||!!h)||f.push(b);var n={};c.replace(H,function(a,b,d,c,e){n[b]=s(d||c||e||"")});d.start&&d.start(b,n,h)}function e(a,b){var c=0,e;if(b=g.lowercase(b))for(c=f.length-1;0<=c&&f[c]!=b;c--);if(0<=c){for(e=f.length-1;e>=c;e--)d.end&&d.end(f[e]);f.length=c}}"string"!==typeof a&&(a=null===a||"undefined"===typeof a?"":""+a);var b,l,f=[],n=a,h;for(f.last=function(){return f[f.length-1]};a;){h="";l=!0;if(f.last()&&y[f.last()])a=a.replace(RegExp("(.*)<\\s*\\/\\s*"+f.last()+"[^>]*>","i"),function(a,b){b=b.replace(I,"$1").replace(J,"$1");d.chars&&d.chars(s(b));return""}),e("",f.last());else{if(0===a.indexOf("<!--"))b=a.indexOf("--",4),0<=b&&a.lastIndexOf("-->",b)===b&&(d.comment&&d.comment(a.substring(4,b)),a=a.substring(b+3),l=!1);else if(z.test(a)){if(b=a.match(z))a=a.replace(b[0],""),l=!1}else if(K.test(a)){if(b=a.match(A))a=a.substring(b[0].length),b[0].replace(A,e),l=!1}else L.test(a)&&((b=a.match(B))?(b[4]&&(a=a.substring(b[0].length),b[0].replace(B,c)),l=!1):(h+="<",a=a.substring(1)));l&&(b=a.indexOf("<"),h+=0>b?a:a.substring(0,b),a=0>b?"":a.substring(b),d.chars&&d.chars(s(h)))}if(a==n)throw M("badparse",a);n=a}e()}function s(a){if(!a)return"";var d=N.exec(a);a=d[1];var c=d[3];if(d=d[2])p.innerHTML=d.replace(/</g,"&lt;"),d="textContent"in p?p.textContent:p.innerText;return a+d+c}function C(a){return a.replace(/&/g,"&amp;").replace(O,function(a){var c=a.charCodeAt(0);a=a.charCodeAt(1);return"&#"+(1024*(c-55296)+(a-56320)+65536)+";"}).replace(P,function(a){return"&#"+a.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function t(a,d){var c=!1,e=g.bind(a,a.push);return{start:function(a,l,f){a=g.lowercase(a);!c&&y[a]&&(c=a);c||!0!==D[a]||(e("<"),e(a),g.forEach(l,function(c,f){var k=g.lowercase(f),l="img"===a&&"src"===k||"background"===k;!0!==Q[k]||!0===E[k]&&!d(c,l)||(e(" "),e(f),e('="'),e(C(c)),e('"'))}),e(f?"/>":">"))},end:function(a){a=g.lowercase(a);c||!0!==D[a]||(e("</"),e(a),e(">"));a==c&&(c=!1)},chars:function(a){c||e(C(a))}}}var M=g.$$minErr("$sanitize"),B=/^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/,A=/^<\/\s*([\w:-]+)[^>]*>/,H=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,L=/^</,K=/^<\//,I=/\x3c!--(.*?)--\x3e/g,z=/<!DOCTYPE([^>]*?)>/i,J=/<!\[CDATA\[(.*?)]]\x3e/g,O=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,P=/([^\#-~| |!])/g,x=m("area,br,col,hr,img,wbr");q=m("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr");r=m("rp,rt");var w=g.extend({},r,q),u=g.extend({},q,m("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),v=g.extend({},r,m("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),y=m("script,style"),D=g.extend({},x,u,v,w),E=m("background,cite,href,longdesc,src,usemap"),Q=g.extend({},E,m("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),p=document.createElement("pre"),N=/^(\s*)([\s\S]*?)(\s*)$/;g.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(a){return function(d){var c=[];G(d,t(c,function(c,b){return!/^unsafe/.test(a(c,b))}));return c.join("")}}]});g.module("ngSanitize").filter("linky",["$sanitize",function(a){var d=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"]/,c=/^mailto:/;return function(e,b){function l(a){a&&k.push(F(a))}function f(a,c){k.push("<a ");g.isDefined(b)&&(k.push('target="'),k.push(b),k.push('" '));k.push('href="');k.push(a);k.push('">');l(c);k.push("</a>")}if(!e)return e;for(var n,h=e,k=[],m,p;n=h.match(d);)m=n[0],n[2]==n[3]&&(m="mailto:"+m),p=n.index,l(h.substr(0,p)),f(m,n[0].replace(c,"")),h=h.substring(p+n[0].length);l(h);return a(k.join(""))}}])}(window,window.angular);"use strict";angular.module("btford.markdown",["ngSanitize"]).provider("markdownConverter",function(){var opts={};return{config:function(newOpts){opts=newOpts},$get:function(){return new Showdown.converter(opts)}}}).directive("btfMarkdown",function($sanitize,markdownConverter){return{restrict:"AE",link:function(scope,element,attrs){if(attrs.btfMarkdown)scope.$watch(attrs.btfMarkdown,function(newVal){var html=newVal?$sanitize(markdownConverter.makeHtml(newVal)):"";element.html(html)});else{var html=$sanitize(markdownConverter.makeHtml(element.text()));element.html(html)}}}});</script>
<script>"use strict";angular.module("helium.templates",["html/admin-menu.html","html/admin.html","html/admin.settings.html","html/authenticate.html","html/homepage.html","html/login.html","html/post.html"]),angular.module("html/admin-menu.html",[]).run(["$templateCache",function(a){a.put("html/admin-menu.html",'<div class="dropdown pull-right admin-dropdown" ng-controller="AdminMenu"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown">Admin <span class="caret"></span></button><ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1"><li role="presentation" ng-if="makingNewPost() !== true"><a role="menuitem" tabindex="-1" ng-click="newPost()">New post</a></li><li role="presentation" ng-if="$state.is(\'post\') === true && editingPost() !== true && makingNewPost() !== true"><a role="menuitem" tabindex="-1" ui-sref="post({ postId: post.id, edit: true })">Edit post</a></li><li role="presentation" ng-if="$state.is(\'post\') === true && makingNewPost() !== true"><a role="menuitem" tabindex="-1" ng-click="deletePost(post.id)">Delete post</a></li><li role="presentation" ng-if="editingPost() === true || makingNewPost() === true"><a role="menuitem" tabindex="-1" ng-click="savePost(post)">Save post</a></li><li role="presentation" class="divider" ng-if="$state.is(\'settings\') !== true"></li><li role="presentation" ng-if="$state.is(\'settings\') !== true"><a role="menuitem" tabindex="-1" ui-sref="settings">Settings</a></li><li role="presentation" class="divider"></li><li role="presentation"><a role="menuitem" ng-click="signOut()" tabindex="-1">Sign out</a></li></ul></div>')}]),angular.module("html/admin.html",[]).run(["$templateCache",function(a){a.put("html/admin.html",'<div ng-if="verificationResults === true"><div ui-view></div></div>')}]),angular.module("html/admin.settings.html",[]).run(["$templateCache",function(a){a.put("html/admin.settings.html",'<div><form role="form"><h2>Website settings</h2><div class="form-group"><label for="name">Name</label><input type="text" class="form-control" id="name" ng-model="profile.name"></div><div class="form-group"><label for="picture">Picture</label><input type="file" id="picture" he-onfileselect="picture"><p class="help-block" ng-if="profile.pictureUrl !== undefined">Current image is <code>{{profile.pictureUrl}}</code></p></div><div class="form-group"><label for="headerImage">Header image</label><input type="file" id="headerImage" he-onfileselect="headerImage"><p class="help-block">This is a big image that will appear at the top of the homepage.</p><p class="help-block" ng-if="profile.headerImageUrl !== undefined">Current image is <code>{{profile.headerImageUrl}}</code></p></div><div class="form-group"><label for="bio">Bio</label><textarea class="form-control" id="bio" ng-model="profile.bio" rows="5"></textarea><p class="help-block">This text will also appear on your homepage. You can use HTML or Markdown to write this, so you can do links, images, whatever you want!</p></div><div class="form-group"><label for="socialLinks">Social links</label><textarea class="form-control" id="socialLinks" ng-model="profile.socialLinks" rows="5"></textarea><p class="help-block">Put the links to your web profiles (Facebook, Twitter, Goolge+, etc) in this box. They will appear as icons on the homepage. Each link should be in a new line.<br><br>For example:<br><br>http://twitter.com/msafi<br>http://facebook.com/mksafi<br>http://instagram.com/msafi<br>https://github.com/msafi/<br></p></div><hr><button type="button" ng-click="submit()" class="btn btn-primary btn-lg btn-block" ng-disabled="globals.loading === true">Save</button></form></div>')}]),angular.module("html/authenticate.html",[]).run(["$templateCache",function(a){a.put("html/authenticate.html","<pre>{{error | json}}</pre>")}]),angular.module("html/homepage.html",[]).run(["$templateCache",function(a){a.put("html/homepage.html",'<div><h2 ng-repeat="post in posts"><a ui-sref="post({ postId: post.id })">{{post.title}}</a> <small>{{post.id | date: \'fullDate\'}}</small></h2><h2 ng-if="posts.length === 0">You don\'t have any posts, yet.</h2></div>')}]),angular.module("html/login.html",[]).run(["$templateCache",function(a){a.put("html/login.html",'<div><div class="alert alert-warning" role="alert" ng-if="initializing">{{initializingMessage}}</div><div class="alert alert-danger" role="alert" ng-if="message && initializing !== true">{{message}}</div><button type="button" class="btn btn-primary btn-lg btn-block" ng-click="authenticate()" ng-disabled="initializing === true">Login</button></div>')}]),angular.module("html/post.html",[]).run(["$templateCache",function(a){a.put("html/post.html",'<article ng-show="displayPublishedPost()"><h1>{{post.title}} <small>{{post.id | date:\'fullDate\'}}</small></h1><div btf-markdown="post.body"></div></article><article ng-class="{ away: displayPublishedPost() }"><div class="alert alert-danger" role="alert" ng-if="errorMessage !== undefined">{{errorMessage}}</div><form class="form-horizontal" role="form" name="newPostForm"><textarea rows="1" ng-model="post.title" class="form-control" placeholder="Title..." id="postTitle" ng-disabled="globals.loading === true" required></textarea><br><textarea class="form-control" rows="20" ng-model="post.body" placeholder="Your post..." id="postBody" ng-disabled="globals.loading === true" required></textarea></form><br><ul><li>Press Cmd+P to toggle preview</li><li>Press Cmd+Enter to save and publish the post</li></ul></article>')}]),angular.module("helium",["helium.templates","ui.router","btford.markdown"]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(a,b,c){a.state("homepage",{url:"/",templateUrl:"html/homepage.html",controller:"Homepage"}).state("login",{url:"/login?state&authError",templateUrl:"html/login.html",controller:"Login"}).state("settings",{url:"/settings",templateUrl:"html/admin.settings.html",controller:"AdminSettings"}).state("admin",{url:"/admin",templateUrl:"html/admin.html",controller:"Admin",resolve:{verificationResults:["user",function(a){return a.authenticate().then(function(){return!0},function(){return!1})}]}}).state("post",{url:"/{postId:[0-9]{13,}}?new&edit",templateUrl:"html/post.html",controller:"Post"}),b.otherwise("/"),c.html5Mode(!1).hashPrefix("!"),String.prototype.format||(String.prototype.format=function(){var a=arguments;return this.replace(/\{(\d+)\}/g,function(b,c){return c in a?a[c]:b})})}]),angular.module("helium").service("aws",["$q","config","user","lStorage","systemConfig",function(a,b,c,d,e){var f={},g=b.amazonRoleArn,h=b.amazonS3BucketName,i="https://s3.amazonaws.com/"+h,j={params:{Bucket:h}},k=b.amazonAccountId,l=b.amazonCognitoIdentityPoolId,m=b.amazonCognitoRoleArn;return angular.extend(f,{bucketUrl:i,authenticate:function(){return c.authenticate().then(function(){return(null===AWS.config.credentials||AWS.config.credentials.params.RoleArn!==g)&&(AWS.config.credentials=new AWS.WebIdentityCredentials({RoleArn:g,WebIdentityToken:d.getVal("idToken")})),!0})},authenticateWithCognitoIfNecessary:function(){return null!==AWS.config.credentials&&AWS.config.credentials.params.RoleArn===g?!0:void((null===AWS.config.credentials||AWS.config.credentials.params.RoleArn!==m)&&(AWS.config.region="us-east-1",AWS.config.credentials=new AWS.CognitoIdentityCredentials({AccountId:k,IdentityPoolId:l,RoleArn:m})))},putObject:function(b){return f.authenticate().then(function(){var c=a.defer();return new AWS.S3(j).putObject({Bucket:h,Key:b.key,Body:b.body||b,ContentType:b.type,ACL:b.acl,Metadata:{data:angular.toJson(b.metadata)}}).on("httpUploadProgress",function(a){c.notify({loaded:a.loaded,total:a.total})}).on("success",function(a){c.resolve(a)}).on("error",function(a){c.reject(a)}).send(),c.promise})},getObject:function(b){return f.authenticate().then(function(){var c=a.defer();return new AWS.S3(j).getObject({Bucket:h,Key:b}).on("success",function(a){c.resolve(a)}).on("error",function(a){c.reject({error:a})}).send(),c.promise})},listObjects:function(b){var c=a.defer();return b=b||{},f.authenticateWithCognitoIfNecessary(),new AWS.S3(j).listObjects({Bucket:h,Marker:b.marker||null,MaxKeys:b.maxKeys||e.listObjectMaxKeys,Prefix:b.prefix||null}).on("success",function(a){c.resolve(a)}).on("error",function(a){c.reject({error:a})}).send(),c.promise},deleteObject:function(b){return f.authenticate().then(function(){var c=a.defer();return new AWS.S3(j).deleteObject({Bucket:h,Key:b}).on("success",function(a){c.resolve(a)}).on("error",function(a){c.reject({error:a})}).send(),c.promise})},headObject:function(b){var c=a.defer();return f.authenticateWithCognitoIfNecessary(),new AWS.S3(j).headObject({Bucket:h,Key:b}).on("success",function(a){a.data.Metadata.data=angular.fromJson(a.data.Metadata.data),c.resolve(a)}).on("error",function(a){c.reject({error:a})}).send(),c.promise}})}]),angular.module("helium").service("backend",["$q","config","user","lStorage","$http","aws",function(a,b,c,d,e,f){var g={},h=f.bucketUrl;return angular.extend(g,{uploadJson:function(a){return a.body=angular.toJson(a.body),a.type="application/json",g.uploadFile(a)},uploadFile:function(a){return f.putObject(a)},getFile:function(b){var d={method:"GET",url:h+"/"+b};return c.hasValidCredentials()&&(d.headers={"cache-control":"no-cache"}),e(d).then(function(a){return a.data},function(b){return a.reject({error:b.statusText})})},deleteFile:function(a){return f.deleteObject(a)},listFiles:function(a){return f.listObjects(a).then(function(a){return a.data})},getFileMeta:function(a){return f.headObject(a).then(function(a){return a.data.Metadata.data})}})}]),angular.module("helium").service("blogManager",["backend","systemConfig","$q","utils","$state","config",function(a,b,c,d,e,f){var g={};return angular.extend(g,{updateConfig:function(b){return f=angular.extend(f,b),a.getFile("index.html").then(function(b){return b=b.replace(/(heliumConfigurations = {(.*\n)+};;;)/gm,"heliumConfigurations = "+JSON.stringify(f,null,2)+";;;"),a.uploadFile({key:"index.html",body:b,acl:"public-read",type:"text/html"})})}})}]),angular.module("helium").constant("config",heliumConfigurations),angular.module("helium").service("gapi",["config","$q","$http",function(a,b,c){var d={},e=a.googleClientId;return angular.extend(d,{authorize:function(a){var c=b.defer();return a=a||{},a.immediate=void 0===a.immediate,gapi.auth.authorize({client_id:e,response_type:"token id_token",cookie_policy:"single_host_origin",immediate:a.immediate,scope:"email"},function(a){void 0!==a.error?c.reject(a):c.resolve(a)}),c.promise},signOut:function(){return d.authorize().then(function(a){return a},function(a){return b.reject(a)}).then(function(a){return c({method:"JSONP",url:"https://accounts.google.com/o/oauth2/revoke?token="+a.access_token})})}})}]),angular.module("helium").service("keyboard",["$document","$rootScope",function(a,b){var c={},d=[],e={p:[80],cmd:"metaKey",enter:[13]};return a.off("keydown.keyboard"),b.$on("$stateChangeSuccess",function(){a.off("keydown.keyboard")}),b.$on("$destroy",function(){a.off("keydown.keyboard")}),angular.extend(c,{bind:function(c,f,g){var h=""+_.sortBy(c)+(""+f);_.contains(d,h)===!0?a.off("keydown.keyboard."+h):d.push(h),a.on("keydown.keyboard."+h,function(a){var d=_.map(c,function(b){return a[e[b]]===!0});_.all(d)===!0&&_.contains(e[f],a.keyCode)===!0&&(a.preventDefault(),b.$apply(function(){g()}))})}})}]),angular.module("helium").service("lStorage",function(){return{setVal:function(a,b){localStorage[a]=angular.toJson({value:b})},getVal:function(a){return void 0===localStorage[a]?void 0:angular.fromJson(localStorage[a]).value},removeItem:function(a){return void 0===localStorage[a]?void 0:localStorage.removeItem(a)}}}),angular.module("helium").service("mediaManager",["backend","systemConfig","$q",function(a,b,c){var d={};return angular.extend(d,{uploadImage:function(c){var d=b.general.filePaths.media;return a.uploadFile(angular.extend(c,{key:d+c.name,acl:"public-read"}))},loadFile:function(a){var b=c.defer(),d=new FileReader;return d.onload=function(a){b.resolve(a.target.result)},d.readAsDataURL(a),b.promise}})}]),angular.module("helium").service("pageTitle",["reactToRouteChange","config","$rootScope","systemConfig",function(a,b,c,d){var e={value:void 0},f=b.name,g=d.messages.homepageTitlePrefix;return a([{name:"homepage",value:g+f},{name:"default",value:g+f}],e,"value"),c.$on("post",function(a,b){e.value=b.title+" | "+f}),e}]),angular.module("helium").service("postManager",["$q","utils","backend","blogManager","systemConfig",function(a,b,c,d,e){function f(a){return e.general.filePaths.posts+a+".json"}var g={},h={};return angular.extend(g,{savePost:function(a){var b={};return b.key=f(a.id),b.body=a,b.acl="public-read",b.metadata={title:a.title,id:a.id},c.uploadJson(b)},getPosts:function(){return c.listFiles({prefix:"content/posts/"}).then(function(b){var d=[];return _.each(b.Contents,function(a){d.push(c.getFileMeta(a.Key))}),a.all(d)}).then(function(a){return a.reverse()},function(a){return a})},getPost:function(b,d){return b===h.id&&d!==!1?a.when(h):c.getFile(f(b)).then(function(a){return h=a,a})},generateId:function(){return b.currentTime()},deletePost:function(a){return c.deleteFile(f(a))},rebuildPosts:function(){return a.when()},cachePost:function(a){h=a}})}]),angular.module("helium").service("reactToRouteChange",["$state","$rootScope",function(a,b){return function(c,d,e){function f(a){d[e]=(_.find(c,{name:a})||_.last(c)).value}f(a.current.name),b.$on("$stateChangeSuccess",function(a,b){f(b.name)})}}]),angular.module("helium").constant("systemConfig",{general:{filePaths:{posts:"content/posts/",media:"content/media/"}},supportedSiteLinks:["twitter.com","facebook.com","plus.google.com","github.com","instagram.com"],messages:{adminAuthError:"Restricted area. You need to log-in.",invalidForm:"You need to fill things out.",googleAuthenticationError:"User could not be authenticated with Google.",blogNotInitialized:"This blog has not been initialized yet. If you are the admin, log-in to kick off automatic initialization.",initializing:"Please wait while your blog is being initialized for first time use.",blogInitializationFailed:"An error occurred during blog initialization.",genericError:"An error occurred. Check your browser developer console.",confirmPostDeletion:"This post is about to be deleted...",homepageTitlePrefix:"Website of "},listObjectsMaxKeys:10,ui:{adminPostTitle:"Make a new post",adminManagePostsTitle:"Manage posts"}}),angular.module("helium").service("user",["config","systemConfig","lStorage","utils","gapi","$q",function(a,b,c,d,e,f){var g={};return angular.extend(g,{isAdmin:function(){var b=c.getVal("identity");return a.amazonRoleArn===b},hasValidCredentials:function(){var a=d.currentTime(),b=c.getVal("credentialsExpirationTime");return void 0!==b&&b>a&&g.isAdmin()===!0},authenticate:function(g){var h=f.defer();return this.hasValidCredentials()?h.resolve(!0):e.authorize(g).then(function(b){c.setVal("credentialsExpirationTime",d.currentTime()+36e5),c.setVal("idToken",b.id_token),c.setVal("identity",a.amazonRoleArn),h.resolve(!0)},function(){h.reject({error:b.messages.googleAuthenticationError})}),h.promise},signOut:function(){return e.signOut().finally(function(){c.removeItem("credentialsExpirationTime"),c.removeItem("idToken"),c.removeItem("identity")})}})}]),angular.module("helium").service("utils",function(){function a(){for(var a={},b=location.hash.substring(1),c=/([^&=]+)=([^&]*)/g,d=c.exec(b);d;)a[decodeURIComponent(d[1])]=decodeURIComponent(d[2]),d=c.exec(b);return a}return{currentTime:function(){return(new Date).getTime()},parseHashQs:a}}),angular.module("helium").controller("Admin",["$scope","verificationResults","$state","systemConfig",function(a,b,c,d){return b!==!0?(c.go("login",{authError:d.messages.adminAuthError}),!1):void angular.extend(a,{verificationResults:b})}]),angular.module("helium").controller("AdminMenu",["$scope","user","$state","postManager","$location","$rootScope","systemConfig",function(a,b,c,d,e,f,g){angular.extend(a,{makingNewPost:function(){return c.is("post")===!0&&"true"===e.search().new},editingPost:function(){return c.is("post")===!0&&"true"===e.search().edit},newPost:function(){c.go("post",{postId:d.generateId(),"new":!0},{inherit:!1})},savePost:function(){f.$broadcast("savePost")},deletePost:function(b){confirm(g.messages.confirmPostDeletion)&&(a.globals.loading=!0,d.deletePost(b).finally(function(){a.globals.loading=!1,c.go("homepage",{reload:!0})}))},signOut:function(){a.globals.loading=!0,b.signOut().finally(function(){a.globals.loading=!1,c.go("homepage",{reload:!0})})}})}]),angular.module("helium").controller("AdminSettings",["$scope","config","blogManager","mediaManager","$q","systemConfig",function(a,b,c,d,e,f){function g(a){return _.isString(a)?(a=a.split("\n"),_.transform(f.supportedSiteLinks,function(b,c){b[c]=_.find(a,function(a){return _.contains(a,c)})},{})):_.reduce(a,function(a,b){return a+"\n"+b})}angular.extend(a,{profile:{name:b.name,bio:b.bio,pictureUrl:b.picture,headerImageUrl:b.headerImage,socialLinks:g(b.socialLinks)},picture:function(b){a.profile.picture=b[0]},headerImage:function(b){a.profile.headerImage=b[0]},submit:function(){var f={picture:void 0!==a.profile.picture?d.uploadImage(a.profile.picture):void 0,headerImage:void 0!==a.profile.headerImage?d.uploadImage(a.profile.headerImage):void 0};a.globals.loading=!0,e.all(f).then(function(d){var e=a.profile.name,f=a.profile.bio,h=void 0!==d.picture?b.siteUrl+d.picture.request.params.Key:void 0,i=void 0!==d.headerImage?b.siteUrl+d.headerImage.request.params.Key:void 0,j=_.isString(a.profile.socialLinks)===!0?g(a.profile.socialLinks):void 0;return c.updateConfig({name:e,picture:h,headerImage:i,bio:f,socialLinks:j})}).finally(function(){a.globals.loading=!1})}})}]),angular.module("helium").controller("Homepage",["$scope","postManager",function(a,b){a.globals.loading=!0,b.getPosts().then(function(b){a.posts=b}).finally(function(){a.globals.loading=!1})}]),angular.module("helium").controller("Login",["$scope","user","$state","$stateParams","systemConfig",function(a,b,c,d,e){angular.extend(a,{message:d.authError,authenticate:function(){return b.authenticate({immediate:!1}).then(function(){c.go("homepage")},function(b){a.message=e.messages.genericError,console.log(b)})}})}]),angular.module("helium").controller("Main",["$scope","config","$state","$rootScope","reactToRouteChange","pageTitle","user",function(a,b,c,d,e,f,g){d.$on("post",function(b,c){a.post=c}),d.$on("$stateChangeStart",function(){a.post=void 0}),angular.extend(a,{name:b.name,$state:c,globals:{loading:!1},pageTitle:f,isAdmin:g.isAdmin})}]),angular.module("helium").controller("Post",["$scope","$stateParams","postManager","$rootScope","$state","keyboard","systemConfig",function(a,b,c,d,e,f,g){var h=parseInt(b.postId);angular.extend(a,{preview:!1,displayPublishedPost:function(){return a.preview===!0||"true"!==b.new&&"true"!==b.edit},savePost:function(){a.newPostForm.$valid===!0?(a.globals.loading=!0,a.post.id=h,c.savePost(a.post).then(function(){e.go("post",{postId:h},{inherit:!1,reload:!0})},function(a){console.log(a)}).finally(function(){a.globals.loading=!1})):a.errorMessage=g.messages.invalidForm}}),"true"===b.new?a.post={}:(a.globals.loading=!0,c.getPost(h,"true"===b.edit).then(function(a){d.$broadcast("post",a)}).finally(function(){a.globals.loading=!1})),d.$on("savePost",function(){a.savePost()}),f.bind(["cmd"],"p",function(){a.preview=!a.preview}),f.bind(["cmd"],"enter",function(){("true"===b.edit||"true"===b.new)&&a.savePost()})}]),angular.module("helium").directive("heOnfileselect",function(){return{scope:{heOnfileselect:"="},link:function(a,b){b.on("change",function(b){a.heOnfileselect(b.target.files)})}}});</script>
<!-- endfileblock -->

<script src="//apis.google.com/js/client.js?onload=handleClientLoad"></script>

</body>
</html>
<!--

  This website is powered by Helium http://lightelement.github.io/helium

-->
